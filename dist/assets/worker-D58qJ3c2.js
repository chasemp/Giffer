const i="0.12.1",f=`https://unpkg.com/@ffmpeg/core@${i}/dist/umd/ffmpeg-core.js`;var o;(function(r){r.LOAD="LOAD",r.EXEC="EXEC",r.WRITE_FILE="WRITE_FILE",r.READ_FILE="READ_FILE",r.DELETE_FILE="DELETE_FILE",r.RENAME="RENAME",r.CREATE_DIR="CREATE_DIR",r.LIST_DIR="LIST_DIR",r.DELETE_DIR="DELETE_DIR",r.ERROR="ERROR",r.DOWNLOAD="DOWNLOAD",r.PROGRESS="PROGRESS",r.LOG="LOG"})(o||(o={}));const D=new Error("unknown message type"),L=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),l=new Error("failed to import ffmpeg-core.js");let t;const O=async({coreURL:r=f,wasmURL:s,workerURL:E})=>{const n=!t,e=r,c=s||r.replace(/.js$/g,".wasm"),a=E||r.replace(/.js$/g,".worker.js");try{importScripts(e)}catch{if(self.createFFmpegCore=(await import(e)).default,!self.createFFmpegCore)throw l}return t=await self.createFFmpegCore({mainScriptUrlOrBlob:`${e}#${btoa(JSON.stringify({wasmURL:c,workerURL:a}))}`}),t.setLogger(R=>self.postMessage({type:o.LOG,data:R})),t.setProgress(R=>self.postMessage({type:o.PROGRESS,data:R})),n},m=({args:r,timeout:s=-1})=>{t.setTimeout(s),t.exec(...r);const E=t.ret;return t.reset(),E},I=({path:r,data:s})=>(t.FS.writeFile(r,s),!0),u=({path:r,encoding:s})=>t.FS.readFile(r,{encoding:s}),S=({path:r})=>(t.FS.unlink(r),!0),A=({oldPath:r,newPath:s})=>(t.FS.rename(r,s),!0),w=({path:r})=>(t.FS.mkdir(r),!0),k=({path:r})=>{const s=t.FS.readdir(r),E=[];for(const n of s){const e=t.FS.stat(`${r}/${n}`),c=t.FS.isDir(e.mode);E.push({name:n,isDir:c})}return E},_=({path:r})=>(t.FS.rmdir(r),!0);self.onmessage=async({data:{id:r,type:s,data:E}})=>{const n=[];let e;try{if(s!==o.LOAD&&!t)throw L;switch(s){case o.LOAD:e=await O(E);break;case o.EXEC:e=m(E);break;case o.WRITE_FILE:e=I(E);break;case o.READ_FILE:e=u(E);break;case o.DELETE_FILE:e=S(E);break;case o.RENAME:e=A(E);break;case o.CREATE_DIR:e=w(E);break;case o.LIST_DIR:e=k(E);break;case o.DELETE_DIR:e=_(E);break;default:throw D}}catch(c){self.postMessage({id:r,type:o.ERROR,data:c.toString()});return}e instanceof Uint8Array&&n.push(e.buffer),self.postMessage({id:r,type:s,data:e},n)};
