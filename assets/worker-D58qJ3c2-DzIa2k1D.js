const R="0.12.1",p=`https://unpkg.com/@ffmpeg/core@${R}/dist/umd/ffmpeg-core.js`;var o;(function(e){e.LOAD="LOAD",e.EXEC="EXEC",e.WRITE_FILE="WRITE_FILE",e.READ_FILE="READ_FILE",e.DELETE_FILE="DELETE_FILE",e.RENAME="RENAME",e.CREATE_DIR="CREATE_DIR",e.LIST_DIR="LIST_DIR",e.DELETE_DIR="DELETE_DIR",e.ERROR="ERROR",e.DOWNLOAD="DOWNLOAD",e.PROGRESS="PROGRESS",e.LOG="LOG"})(o||(o={}));const L=new Error("unknown message type"),f=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),D=new Error("failed to import ffmpeg-core.js");let a;const d=async({coreURL:e=p,wasmURL:r,workerURL:s})=>{const E=!a,t=e,c=r||e.replace(/.js$/g,".wasm"),i=s||e.replace(/.js$/g,".worker.js");try{importScripts(t)}catch{if(self.createFFmpegCore=(await import(t)).default,!self.createFFmpegCore)throw D}return a=await self.createFFmpegCore({mainScriptUrlOrBlob:`${t}#${btoa(JSON.stringify({wasmURL:c,workerURL:i}))}`}),a.setLogger(n=>self.postMessage({type:o.LOG,data:n})),a.setProgress(n=>self.postMessage({type:o.PROGRESS,data:n})),E},m=({args:e,timeout:r=-1})=>{a.setTimeout(r),a.exec(...e);const s=a.ret;return a.reset(),s},l=({path:e,data:r})=>(a.FS.writeFile(e,r),!0),F=({path:e,encoding:r})=>a.FS.readFile(e,{encoding:r}),g=({path:e})=>(a.FS.unlink(e),!0),I=({oldPath:e,newPath:r})=>(a.FS.rename(e,r),!0),S=({path:e})=>(a.FS.mkdir(e),!0),u=({path:e})=>{const r=a.FS.readdir(e),s=[];for(const E of r){const t=a.FS.stat(`${e}/${E}`),c=a.FS.isDir(t.mode);s.push({name:E,isDir:c})}return s},w=({path:e})=>(a.FS.rmdir(e),!0);self.onmessage=async({data:{id:e,type:r,data:s}})=>{const E=[];let t;try{if(r!==o.LOAD&&!a)throw f;switch(r){case o.LOAD:t=await d(s);break;case o.EXEC:t=m(s);break;case o.WRITE_FILE:t=l(s);break;case o.READ_FILE:t=F(s);break;case o.DELETE_FILE:t=g(s);break;case o.RENAME:t=I(s);break;case o.CREATE_DIR:t=S(s);break;case o.LIST_DIR:t=u(s);break;case o.DELETE_DIR:t=w(s);break;default:throw L}}catch(c){self.postMessage({id:e,type:o.ERROR,data:c.toString()});return}t instanceof Uint8Array&&E.push(t.buffer),self.postMessage({id:e,type:r,data:t},E)};
